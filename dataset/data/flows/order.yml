version: "2.0"

actions:
  - action_change_order
  - action_confirm_order_invalid_input
  - action_confirm_order_details
  - action_create_order
  - action_on_order_unlocked
  - action_payment_callback

intents:
  - EXTERNAL_confirm_order_details
  - EXTERNAL_order_unlocked
  - EXTERNAL_payment_callback

rules:
  - rule: Confirm order details / affirm
    condition:
      - slot_was_set:
          - chat_type: private
    steps:
      - intent: EXTERNAL_confirm_order_details
      - action: action_confirm_order_details
      - intent: affirm
      - action: action_create_order
  - rule: Confirm order details / deny
    condition:
      - slot_was_set:
          - chat_type: private
    steps:
      - intent: EXTERNAL_confirm_order_details
      - action: action_confirm_order_details
      - intent: deny
      - action: action_change_order
  - rule: Confirm order details / nlu_fallback
    condition:
      - slot_was_set:
          - chat_type: private
    steps:
      - intent: EXTERNAL_confirm_order_details
      - action: action_confirm_order_details
      - intent: nlu_fallback
      - action: action_confirm_order_invalid_input
  - rule: Order unlocked
    condition:
      - slot_was_set:
          - chat_type: private
    steps:
      - intent: EXTERNAL_order_unlocked
      - action: action_on_order_unlocked
  - rule: Payment callback
    condition:
      - slot_was_set:
          - chat_type: private
    steps:
      - intent: EXTERNAL_payment_callback
      - action: action_payment_callback
